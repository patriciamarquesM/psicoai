<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>PsicoAi — Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <style>
    .kpis{display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:16px}
    .kpi{border:1px solid var(--border); border-radius:12px; padding:16px; background:var(--surface); box-shadow:var(--shadow)}
    .kpi-num{font-size:36px; font-weight:700}
    .kpi-label{color:var(--muted)}
  </style>
</head>
<body>
  <main class="container">
    <section class="panel">
      <h2>Resumo</h2>
      <div class="kpis">
        <div class="kpi"><div class="kpi-num" id="kpiPatients">—</div><div class="kpi-label">Pacientes</div></div>
        <div class="kpi"><div class="kpi-num" id="kpiRecords">—</div><div class="kpi-label">Sessões</div></div>
        <div class="kpi"><div class="kpi-num" id="kpiThisMonth">—</div><div class="kpi-label">Minutos no mês</div></div>
      </div>
    </section>

    <section class="panel">
      <h2>Ações rápidas</h2>
      <div class="row">
        <a class="btn primary" href="pacientes.html">Novo paciente</a>
        <a class="btn" href="transcricao.html">Nova transcrição</a>
        <a class="btn" href="prontuario.html">Abrir prontuário</a>
        <a class="btn" href="relatorios.html">Gerar relatório</a>
        <a class="btn" href="configuracoes.html">Configurações</a>
      </div>
    </section>
  </main>

  <script src="shell.js"></script>
  <script type="module">
    const KEY='psicoai_db_v1';
    const db = JSON.parse(localStorage.getItem(KEY)||'{}');
    const patients = db.patients||[];
    const records  = db.records ||[];
    const m = new Date().toISOString().slice(0,7);
    const minMonth = records.filter(r => (r.createdAt||'').slice(0,7)===m)
                            .reduce((s,r)=> s + (+r.duration||0), 0);
    document.getElementById('kpiPatients').textContent = patients.length;
    document.getElementById('kpiRecords').textContent  = records.length;
    document.getElementById('kpiThisMonth').textContent= minMonth;
  </script>
</body>
</html>
